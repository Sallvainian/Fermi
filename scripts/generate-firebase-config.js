#!/usr/bin/env node

/**
 * Script to generate firebase-config.js from .env file
 * Run this before building for web: node scripts/generate-firebase-config.js
 */

const fs = require('fs');
const path = require('path');

// Read .env file
const envPath = path.join(__dirname, '..', '.env');
const envContent = fs.readFileSync(envPath, 'utf8');

// Parse environment variables
const env = {};
envContent.split('\n').forEach(line => {
  const trimmedLine = line.trim();
  if (trimmedLine && !trimmedLine.startsWith('#')) {
    const [key, ...valueParts] = trimmedLine.split('=');
    const value = valueParts.join('=').trim();
    env[key.trim()] = value;
  }
});

// Generate firebase-config.js content
const firebaseConfig = `// Firebase configuration loaded from environment
// This file is auto-generated by scripts/generate-firebase-config.js
// DO NOT edit manually - run the generation script instead

const firebaseConfig = {
  apiKey: "${env.FIREBASE_API_KEY || ''}",
  authDomain: "${env.FIREBASE_AUTH_DOMAIN || ''}",
  projectId: "${env.FIREBASE_PROJECT_ID || ''}",
  storageBucket: "${env.FIREBASE_STORAGE_BUCKET || ''}",
  messagingSenderId: "${env.FIREBASE_MESSAGING_SENDER_ID || ''}",
  appId: "${env.FIREBASE_APP_ID_WEB || ''}",
  databaseURL: "https://${env.FIREBASE_PROJECT_ID || ''}-default-rtdb.firebaseio.com"
};`;

// Write to web/firebase-config.js
const outputPath = path.join(__dirname, '..', 'web', 'firebase-config.js');
fs.writeFileSync(outputPath, firebaseConfig);

console.log('‚úÖ Generated web/firebase-config.js from .env file');
console.log('üìù Remember to add web/firebase-config.js to .gitignore!');